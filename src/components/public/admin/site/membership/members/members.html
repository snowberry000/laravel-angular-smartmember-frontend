<div class="ui modal">
<div class="row">
    <div class="ibox-content m-b-sm border-bottom">
        <div class="p-xs">
            <div class="row">
                <div class="col-md-9">
                    <div class="pull-left m-r-md">
                        <i class="fa fa-globe text-branded mid-icon"></i>
                    </div>
                    <h2 class="ui header">{{ template_data.title | translate }}</h2>
                    <span>{{template_data.description}}</span>
                </div>
                <div class="col-md-3">
                    <a ng-click="smModal.Show('public.admin.site.membership.import')" class="btn btn-brand btn-large ng-scope">
                        <i class="fa fa-plus"></i>
                        Import Members
                    </a>
                    <a target="_blank" href="{{apiURL}}/role/getCSV?access_token={{$storage.user.access_token}}" class="btn btn-brand btn-large ng-scope">
                        <i class="fa fa-plus"></i>
                        Export Members
                    </a>
                    <a disabled title="Tutorial coming soon!" class="btn btn-default m-t-md" type="button">
                        <i class="fa fa-question"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-content" style="padding-bottom: 70px;">
                    <div class="field" ng-if="pagination.total_count > 10 || query || pagination.current_page > 1 || access_level">
                        <label class="control-label" for="">Search:</label>
                        <input type="text" id="" name="" value="" class="form-control"  ng-model="$parent.query" ng-change="search()" ng-model-options="{debounce: { 'default': 1000, 'blur': 0 } }">
                        Show users that
                        <select ng-change="$parent.access_level ? search() : ''" class="btn btn_outline btn_small" ng-init="$parent.access_level_status='0'" ng-model="$parent.access_level_status" style="width:inherit; font-weight: normal;color: #000 !important;border: 1px solid #ccc; margin-bottom:10px; margin-left:10px;">
                            <option value="1">have</option>
                            <option value="0">don't have</option>
                        </select>
                        <select ng-change="search()" class="btn btn_outline btn_small" ng-init="$parent.access_level=0" ng-model="$parent.access_level" style="width:inherit; font-weight: normal;color: #000 !important;border: 1px solid #ccc; margin-bottom:10px; margin-left:10px;">
                            <option value="0">Choose Access Level</option>
                            <option ng-repeat="access_level in access_levels" value="{{access_level.id}}">{{access_level.name}}</option>
                        </select>
                        <a class="btn btn_outline btn_small btn_outline btn_small" ng-click="$parent.access_level_status='0';$parent.access_level=0" style="margin-bottom:10px; margin-left:10px;">Clear</a>
                    </div>
                    <div ng-if="loading" class="sk-spinner sk-spinner-three-bounce">
                        <div class="sk-bounce1"></div>
                        <div class="sk-bounce2"></div>
                        <div class="sk-bounce3"></div>
                    </div>
                    <table class="ui fixed single line celled stackable table" data-page-size="15" ng-if="data.length > 0 && !loading">
                        <thead>
                        <tr>
                            <th data-hide="title">User</th>
                            <th data-hide="title">Access Levels</th>
                            <th data-hide="title">Role</th>
                            <th data-hide="date">Date</th>
                            <th class="text-right" data-sort-ignore="true">Action</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="next_item in data[ pagination.current_page ]">
                            <td>
                                {{next_item.user.first_name ? next_item.user.first_name + ' ' + next_item.user.last_name : next_item.user.email}}
                                <br ng-hide="next_item.user.first_name" />
                                <div ng-hide="!next_item.user.first_name">
                                    {{next_item.user.email}}
                                </div>
                            </td>
                            <td>
                                {{accessLevelList(next_item)}}
                            </td>
                            <td>
                                {{next_item.type.length > 1 && next_item.type[0].role_types.role_name =='Member' ? next_item.type[1].role_types.role_name : next_item.type[0].role_types.role_name}}
                            </td>
                            <td>
                                {{moment.utc(next_item.created_at).fromNow()}}
                            </td>
                            <td class="text-right">
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="!isAdmin(next_item) && !isAgent(next_item) && !member.access_level_selection" ng-init="next_item.access_level_selection=false" ng-click="stopPropagation($event); next_item.access_level_selection=true">
                                    Grant Access Pass
                                </button>
                                <select ng-if="next_item.access_level_selection" ng-init="next_item.new_access_level=0" ng-model="next_item.new_access_level" class="btn btn_outline btn_small" ng-click="stopPropagation($event);">
                                    <option value="0">Choose Access Level</option>
                                    <option ng-repeat="access_level in access_levels" value="{{access_level.id}}">{{access_level.name}}</option>
                                </select>
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="next_item.access_level_selection" ng-click="stopPropagation($event); addAccessPass(next_item)">
                                    {{next_item.new_access_pass_saving ? 'Saving...': 'Save'}}
                                </button>
                                <button class="btn btn-danger btn-outline btn-sm ng-scope" ng-if="next_item.access_level_selection" ng-click="stopPropagation($event); next_item.access_level_selection=false">
                                    Cancel
                                </button>
                                <br ng-if="next_item.access_level_selection" />
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="!next_item.isTeamMember && isOwner(user)" ng-click="addToTeam(next_item)">
                                    Add To Team
                                </button>
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="!isAdmin(next_item) && isOwner(user)" ng-click="toggleAccess(next_item)">
                                    Make Admin
                                </button>
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="isAdmin(next_item) && isOwner(user)" ng-click="toggleAccess(next_item)">
                                    Revoke Admin Status
                                </button>
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="!isAgent(next_item)" ng-click="toggleAgent(next_item)">
                                    Make Agent
                                </button>
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="isAgent(next_item)" ng-click="toggleAgent(next_item)">
                                    Revoke Agent Status
                                </button>
                                <button class="btn btn-danger btn-outline btn-sm ng-scope" ng-click="delete(next_item)">
                                    Delete
                                    <i class="fa fa-trash"></i>
                                </button>

                            </td>
                        </tr>

                        </tbody>
                        <tfoot>
                        <tr>
                        </tr>
                        </tfoot>
                    </table>
                    <pagination total-items="pagination.total_count" max-size="5" items-per-page="25" ng-model="pagination.current_page" class="pagination-sm pull-right" boundary-links="true" ng-change="paginate()" previous-text="&lt;" next-text="&gt;" first-text="&laquo;" last-text="&raquo;"></pagination>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<!--
<div class="ui modal">
    <div class="col-sm-8">
        <h2 class="ui header">{{ template_data.title | translate }}</h2>
        <ol class="breadcrumb">
            <li>
                <a ng-href="/">{{ 'HOME' | translate }}</a>
            </li>
            <li class="active">
                <strong>{{ template_data.title | translate }}</strong>
            </li>
        </ol>
    </div>
</div>

<div class="ui modal">

    <div class="ibox-content m-b-sm border-bottom">
        <div class="p-xs">
            <div class="row">
                <div class="col-md-8">
                    <div class="pull-left m-r-md">
                        <i class="fa fa-globe text-branded mid-icon"></i>
                    </div>
                    <h2 class="ui header">{{ template_data.title | translate }}</h2>
                    <span>{{template_data.description}}</span>
                </div>
                <div class="col-md-4">
                    <a ui-sref="public.admin.site.membership.import" class="btn btn-brand btn-large ng-scope">
                        <i class="fa fa-plus"></i>
                        Import Members
                    </a>
                    <a target="_blank" href="{{apiURL}}/role/getCSV?access_token={{$storage.user.access_token}}" class="btn btn-brand btn-large ng-scope">
                        <i class="fa fa-plus"></i>
                        Export Members
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-content" style="padding-bottom: 70px;">
                    <div class="field" ng-if="pagination.total_count > 10 || query || pagination.current_page > 1 || access_level">
                        <label class="control-label" for="">Search:</label>
                        <input type="text" id="" name="" value="" class="form-control"  ng-model="$parent.query" ng-change="search()" ng-model-options="{debounce: { 'default': 1000, 'blur': 0 } }">
                        Show users that
                        <select ng-change="$parent.access_level ? search() : ''" class="btn btn_outline btn_small" ng-init="$parent.access_level_status='0'" ng-model="$parent.access_level_status" style="width:inherit; font-weight: normal;color: #000 !important;border: 1px solid #ccc; margin-bottom:10px; margin-left:10px;">
                            <option value="1">have</option>
                            <option value="0">don't have</option>
                        </select>
                        <select ng-change="search()" class="btn btn_outline btn_small" ng-init="$parent.access_level=0" ng-model="$parent.access_level" style="width:inherit; font-weight: normal;color: #000 !important;border: 1px solid #ccc; margin-bottom:10px; margin-left:10px;">
                            <option value="0">Choose Access Level</option>
                            <option ng-repeat="access_level in access_levels" value="{{access_level.id}}">{{access_level.name}}</option>
                        </select>
                        <a class="btn btn_outline btn_small btn_outline btn_small" ng-click="$parent.access_level_status='0';$parent.access_level=0" style="margin-bottom:10px; margin-left:10px;">Clear</a>
                    </div>
                    <div ng-if="loading" class="sk-spinner sk-spinner-three-bounce">
                        <div class="sk-bounce1"></div>
                        <div class="sk-bounce2"></div>
                        <div class="sk-bounce3"></div>
                    </div>
                    <table class="ui fixed single line celled stackable table" data-page-size="15" ng-if="data.length > 0 && !loading">
                        <thead>
                        <tr>
                            <th data-hide="title">User</th>
                            <th data-hide="title">Access Levels</th>
                            <th data-hide="title">Role</th>
                            <th data-hide="date">Date</th>
                            <th class="text-right" data-sort-ignore="true">Action</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="next_item in data[ pagination.current_page ]">
                            <td>
                                {{next_item.user.first_name ? next_item.user.first_name + ' ' + next_item.user.last_name : next_item.user.email}}
                                <br ng-hide="next_item.user.first_name" />
                                <div ng-hide="!next_item.user.first_name">
                                    {{next_item.user.email}}
                                </div>
                            </td>
                            <td>
                                {{accessLevelList(next_item)}}
                            </td>
                            <td>
                                {{next_item.type.length > 1 && next_item.type[0].role_types.role_name =='Member' ? next_item.type[1].role_types.role_name : next_item.type[0].role_types.role_name}}
                            </td>
                            <td>
                                {{moment.utc(next_item.created_at).fromNow()}}
                            </td>
                            <td class="text-right">
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="!isAdmin(next_item) && !isAgent(next_item) && !member.access_level_selection" ng-init="next_item.access_level_selection=false" ng-click="stopPropagation($event); next_item.access_level_selection=true">
                                    Grant Access Pass
                                </button>
                                <select ng-if="next_item.access_level_selection" ng-init="next_item.new_access_level=0" ng-model="next_item.new_access_level" class="btn btn_outline btn_small" ng-click="stopPropagation($event);">
                                    <option value="0">Choose Access Level</option>
                                    <option ng-repeat="access_level in access_levels" value="{{access_level.id}}">{{access_level.name}}</option>
                                </select>
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="next_item.access_level_selection" ng-click="stopPropagation($event); addAccessPass(next_item)">
                                    {{next_item.new_access_pass_saving ? 'Saving...': 'Save'}}
                                </button>
                                <button class="btn btn-danger btn-outline btn-sm ng-scope" ng-if="next_item.access_level_selection" ng-click="stopPropagation($event); next_item.access_level_selection=false">
                                    Cancel
                                </button>
                                <br ng-if="next_item.access_level_selection" />
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="!next_item.isTeamMember && isOwner(user)" ng-click="addToTeam(next_item)">
                                    Add To Team
                                </button>
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="!isAdmin(next_item) && isOwner(user)" ng-click="toggleAccess(next_item)">
                                    Make Admin
                                </button>
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="isAdmin(next_item) && isOwner(user)" ng-click="toggleAccess(next_item)">
                                    Revoke Admin Status
                                </button>
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="!isAgent(next_item)" ng-click="toggleAgent(next_item)">
                                    Make Agent
                                </button>
                                <button class="btn btn-brand btn-outline btn-sm" ng-if="isAgent(next_item)" ng-click="toggleAgent(next_item)">
                                    Revoke Agent Status
                                </button>
                                <button class="btn btn-danger btn-outline btn-sm ng-scope" ng-click="delete(next_item)">
                                    Delete
                                    <i class="fa fa-trash"></i>
                                </button>

                            </td>
                        </tr>

                        </tbody>
                        <tfoot>
                        <tr>
                        </tr>
                        </tfoot>
                    </table>
                    <pagination total-items="pagination.total_count" max-size="5" items-per-page="25" ng-model="pagination.current_page" class="pagination-sm pull-right" boundary-links="true" ng-change="paginate()" previous-text="&lt;" next-text="&gt;" first-text="&laquo;" last-text="&raquo;"></pagination>
                </div>
            </div>
        </div>
    </div>
</div>
-->