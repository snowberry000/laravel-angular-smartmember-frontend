<div class="wrapper wrapper-content animated fadeInRight">

	<div class="row">
		<div class="col-lg-12">

			<div class="ibox-content clear_box page-heading">
				<div class="p-xs">
					<div class="row">
						<div class="col-md-9">
							<div class="pull-left m-r-md">
								<i class="fa fa-support text-branded mid-icon"></i>
							</div>
							<h2>{{ 'HELPDESK_TICKETS' | translate }}</h2>
							<span>See all help requests by your visitors, members, and customers.</span>
						</div>
						<div class="col-md-3 text-right">
							<a ui-sref="admin.team.helpdesk.creator" class="btn btn-brand m-t-md btn-large ng-scope">
								<i class="fa fa-plus"></i>
								Create new ticket
							</a>
							<button disabled title="Tutorial coming soon!" class="btn btn-default m-t-md" type="button">
								<i class="fa fa-question"></i>
							</button>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>
	<div class="row">
		<div class="col-lg-12">

			<div class="ibox">
				<div class="ibox-content">
					<div class="form-group">
						<input type="text" placeholder="Search" class="form-control" ng-model="$parent.query" ng-change="search()" ng-model-options="{debounce: { 'default': 1000, 'blur': 0 } }" ng-if="pagination.total_count > 10 || query || pagination.current_page > 1">
					</div>
					<div ng-if="loading" class="sk-spinner sk-spinner-three-bounce">
						<div class="sk-bounce1"></div>
						<div class="sk-bounce2"></div>
						<div class="sk-bounce3"></div>
					</div>

					<div ng-if="!loading && tickets.length==0">
						<p class="alert alert-info">No tickets found</p>
					</div>
					<span ng-if="!loading && tickets.length > 0">{{tickets[pagination.current_page].length}} tickets found</span>

					<table class="footable table table-stripped toggle-arrow-tiny" data-page-size="6" ng-if="tickets.length > 0 && !loading" foonice>
						<thead>
							<tr>
								<th data-hide="phone,tablet">Status</th>
								<th data-toggle="true">Ticket</th>
								<th data-hide="phone">Customer Name</th>
								<th data-hide="all">Customer Email</th>
								<th data-hide="all">Site</th>
								<th data-hide="phone">Last Reply</th>
								<th data-hide="all">Date Created</th>
								<th class="text-right" data-hide="phone,tablet" data-sort-ignore="true">Action</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="next_item in tickets[ pagination.current_page ]">
								<td style="width: 80px;">
									<span class="label m-r-sm" ng-class="{open:'label-danger',pending:'label-warning', solved:'label-success', spam:'label-plain'}[next_item.status]">
										{{next_item.status}}
									</span>
								</td>
								<td class="responsive_table_item">
									{{next_item.subject}}
									<small class="block">{{excerpt(next_item.message)}}</small>
								</td>
								<td style="width: 200px;">
									<strong>{{next_item.user_name}}</strong>
								</td>
								<td>
									{{next_item.user_email}}
								</td>
								<td>
									{{next_item.site_id}}
								</td>
								<td style="width: 140px;">
									{{moment.utc(next_item.updated_at).fromNow()}}
								</td>
								<td style="width: 140px;">
									{{moment.utc(next_item.created_at).fromNow()}}
								</td>
								<td class="text-right" style="width: 100px;">
									<div class="btn-group">
										<a ui-sref="admin.team.helpdesk.ticket({id: next_item.id})" class="btn btn-brand m-t-xs btn-outline btn-md">
											<i class="fa fa-pencil"></i>
											Reply
										</a>
									</div>
								</td>

							</tr>

						</tbody>

					</table>

					<div class="text-right" ng-if="!loading">
						<pagination total-items="pagination.total_count" max-size="5" items-per-page="25" ng-model="pagination.current_page" class="pagination-sm" boundary-links="true" ng-change="paginate()" previous-text="&lt;" next-text="&gt;" first-text="&laquo;" last-text="&raquo;"></pagination>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
